---
title: "Cron Basics"
date: 2024-09-05
categories: setup-basics
# algorithm-leetcode
# code-notes
# setup-basics
---
<!-- 大綱引言 -->
###### Cron 能夠在特定的時間備份數據、清理系統日誌和自動運行腳本，自動化工作流程中是個好用的工具。

<!-- 正文 -->
<br>

### 基本概念

基於 Unix 和類 Unix 系統的定時任務調度器。允許用戶在特定的時間或間隔執行命令或腳本。`cron` 通常作為守護進程運行在系統的後台，並根據設置的 `crontab`（cron table）文件定期檢查並執行任務。

<br>
<br>

### 運作方式

`cron` 的運作像是一個時鐘，而不是計時器。它基於系統時間運行，每分鐘檢查一次當前的時間與 `crontab` 文件中的任務時間是否匹配。每個 user 都可以有自己的 `crontab` 文件，這些文件中定義了該用戶的所有定時任務。系統也可以有一個全局的 `crontab` 文件，通常由系統管理員管理。

- 基於系統時區
  - `cron` 使用系統時區作為時間基準。如果系統時區設置為台灣時間（CST, UTC+8），則 `cron` 任務的時間設定也是基於台灣時間。  
  - 如果更改了系統的時區，`cron` 任務的運行時間將相應調整到新時區的時間。這意味著，如果您的任務需要基於特定時區執行，您需要確保系統時區是正確的。  

<br>
<br>

### Cron Command

`cron` 使用一種特定的語法格式來設置任務時間。這種格式由五個字段組成，分別表示分鐘、時、日、月和星期。  
  

```
0 0 * * * 代表每天午夜 12:00 執行一次任務。

0 0 * * * command_to_run
- - - - -
| | | | |
| | | | +--- 星期幾 (0 - 7) (星期日為 0 或 7)
| | | +----- 月 (1 - 12)
| | +------- 日 (1 - 31)
| +--------- 時 (0 - 23)
+----------- 分 (0 - 59)
```
<br>

- **Command**
  1. 使用命令 `crontab -e` 來編輯當前用戶的 `crontab` 文件。
  2. 添加或修改任務，例如：`0 * * * * /usr/bin/python3 /path/to/script.py`（每小時整點運行一個 Python 腳本）。
  3. 保存修改並退出編輯器。
  4. 使用 `crontab -l` 檢查當前用戶的 `crontab` 任務列表。


<br>

- **問題排除**
  1. 檢查系統日誌：可以查看系統日誌（如 `/var/log/syslog` 或 `/var/log/cron.log`）來了解 `cron` 任務的執行情況。
  2. 確認權限：確保執行的腳本文件有正確的權限和可執行權限。
  3. 手動測試腳本：在終端中手動運行腳本，確保其沒有錯誤。

<br>

- **使用場景**

  1. 定時備份數據。
  2. 監控系統健康狀況。
  3. 自動執行數據抓取任務。
  4. 清理系統日誌或其他臨時文件。